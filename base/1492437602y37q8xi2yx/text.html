<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Аналогична ExecSQL, но позволяет передавать в SQL-блок дополнительные, не участвующие в контексте выборки параметры, а также возвращать их. Имена входящих параметров задаются в ParamNames через точку с запятой. В тексте SQL-запроса можно использовать не только передаваемые в ParamNames параметры, но и использовать параметры, имеющиеся в выборке. В случае совпадения имен параметров, будет использоваться параметр, переданный в вызове <span style=" font-style:italic; color:#ff0000;">ExecSQLEx</span>. Возвращает массив значений параметров, указанных в ParamNames, в том порядке, в котором они перечислены в ParamNames. Если возвращаемый параметр участвует в секции [OUT] sql-запроса, то будет возвращено его новое значение. Если не участвует, то будет возвращено то значение, которое передавалось в ParamValues. Если входящих параметров нет, то можно передавать ParamNames=’’ и ParamValues=[]. Количество параметров должно совпадать с количеством типов и с количеством значений. Все параметры являются входными и могут являться выходными. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">function <span style=" font-weight:600; font-style:italic; color:#ff0000;">ExecSQLEx</span>(<br /><span style=" font-weight:600;">SQLName</span>: <a href="bdn://Pascal/SimpleType/String"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">String</span></a>;<br />var <span style=" font-weight:600;">ParamNames</span>: <a href="bdn://Pascal/SimpleType/String"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">String</span></a>;<br />var <span style=" font-weight:600;">ParamTypes </span>: <a href="bdn://Pascal/SimpleType/Array"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Array</span></a>;<br />var <span style=" font-weight:600;">ParamValues </span>: <a href="bdn://Pascal/SimpleType/Array"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Array</span></a><br />): <a href="bdn://Pascal/SimpleType/Array"><span style=" text-decoration: underline; color:#0000ff;">Array</span></a>;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Примеры</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;SQL&gt;<br />  &lt;Save&gt;<br />     [out sNotionReg] <br />     begin <br />       :sNotionReg := BTK_Loader.OutNotionToScriptText(:idNotion); <br />     end; <br />   &lt;/Save&gt;<br />&lt;/SQL&gt;<br /><br />&lt;Pascal&gt;<br />begin <br />    sRes := <span style=" font-style:italic; color:#ff0000;">ExecSQLEx</span>('save', 'idNotion; sNotionReg ', [ftInteger, ftString], [GetVar('id'), ‘’]); <br />    // возвращаемое значение sNotionReg находится в sRes[1]. <br />    // В sRes[0] находится передаваемый параметр idNotion. <br />    SaveToFile('', sRes[1]); <br />    end;<br />&lt;/Pascal&gt;</p></body></html>