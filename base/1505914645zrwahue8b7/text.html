<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">Использование компилятора ресурсов pyrcc4 в PyQt</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22.75px; background-color:#ffffff;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:13px; color:#444444;">При использовании замечательной питоновской библиотеки PyQT для компиляции ресурсов (например файлов изображений) в код модуля применяется утилита, поставляемая вместе с библиотекой. Находится она в папке bin (а иногда в корне библиотеки) и называется pyrcc4.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22.75px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:13px; color:#444444;">В нашем случае давайте скомпилируем в ресурс файл изображения Qt-logo.png. Для этого выполним несколько несложных действий.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22.75px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:13px; color:#444444;">Создадим файл например res.qrc формата XML, описывающий ресурсы</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">&lt;!DOCTYPE RCC&gt;&lt;RCC version=&quot;1.0&quot;&gt;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">&lt;qresource&gt;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">    &lt;file&gt;Qt-logo.png&lt;/file&gt;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">&lt;/qresource&gt;</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">&lt;/RCC&gt;</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22.75px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:13px; color:#444444;">Затем, нашей утилитой pyrcc4.exe (для Windows) сгенерим питоновский скрипт, содержащий наше изображение, например так:</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">pyrcc4 -o путь_до_файла\rc.py -py2 путь_до_файла\res.qrc</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22.75px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:13px; color:#444444;">Осталось лишь экспортировать код в виде модуля и использовать в наших скриптах, например как показано ниже.</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">from PyQt4 import QtCore, QtGui</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">import sys</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">import rc</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">app = QtGui.QApplication(sys.argv)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">window = QtGui.QWidget()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">window.setWindowTitle(&quot;Simple app with resource&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">window.resize(150, 100)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">image = QtGui.QPixmap(&quot;:/Qt-logo.png&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">label = QtGui.QLabel()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">label.setAlignment(QtCore.Qt.AlignCenter)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">label.setPixmap(image)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">button = QtGui.QPushButton(&quot;&amp;Close&quot;)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">vbox = QtGui.QVBoxLayout()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">vbox.addWidget(label)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">vbox.addWidget(button)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">window.setLayout(vbox)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">QtCore.QObject.connect(</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">    button,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">    QtCore.SIGNAL(&quot;clicked()&quot;),</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">    QtGui.qApp,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">    QtCore.SLOT(&quot;quit()&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">window.show()</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier New,courier'; font-size:13px; color:#444444; background-color:#eeeeee;">sys.exit(app.exec_())</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22.75px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:13px; color:#444444;">Следует отметить, что размер файла ресурса значительно больше размера исходного изображения. Для уменьшения объема можно использовать компрессию.</span></p></body></html>