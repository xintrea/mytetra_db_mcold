<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:19px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,Tahoma,Helvetica,FreeSans,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Работаем с Яндекс.Диск через WebDAV.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%; background-color:#ffffff;"><img src="image367.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">Многие из нас используют в повседневной жизни облачные хранилища, такие как Google Drive, Яндекс.Диск, Облако@Mail.Ru и другие. Однако, немногие знают что существуют альтернативные способы доступа к ним, помимо установки официального приложения. В этом небольшом посте я расскажу о том как можно использовать Яндекс.Диск при помощи WebDAV и о некоторых аспектах практического использования доступа к Яндекс.Диску по WebDAV, например, для создания регулярных резервных копий важной информации, например, для защиты от </span><a href="http://www.decker.su/2015/11/trojan-cryptor-vault-how-to-protect.html"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#727272;">троянов-шифровальщиков</span></a><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">. Здесь и далее будет предполагаться что регулярные резервные копии вашей критически важной информации уже делаются у вас и складываются, например, в отдельную папку, при этом каждой дате соответствует определенный архив.<br /><br />Для начала давайте разберемся что же такое WebDAV. Сам аббревиатура расшифровывается как Web Distributed Authoring and Versioning, другими словами, WebDAV - это протокол передачи данных и работы с ним, работающий поверх HTTP 1.1. С помощью WebDAV можно управлять файлами на сервере, осуществлять основные файловые операции и многое другое. Для нас же важно, что Яндекс.Диск предоставляет </span><a href="https://yandex.ru/support/disk/webdav.xml"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#727272;">доступ по WebDAV</span></a><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;"> к вашему диску, а ОС Windows позволяет подключить WebDAV-ресурс как отдельный сетевой диск (см. статью </span><a href="https://yandex.ru/support/disk/webdav/webdav-win.xml"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#727272;">Сетевой диск в Windows</span></a><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">). Последним способом мы пользоваться не будем, т.к. в случае подключения Яндекс.Диска, как отдельного сетевого диска с назначенной буквой в Windows, есть риски что данные хранящиеся на нем будет изменены вредоносным ПО (например, зашифрованы) и в результате мы получим синхронизированную копию этих данных уже в облаке. Поэтому для организации загрузки файлов резервных копий на Яндекс.Диск через WebDAV мы будем использовать консольный клиент.<br /><br />Также, если вам удобно работать в любом файловом менеджере - например, Far Manager или Total Commander вы можете использовать соответствующие плагины, позволяющие работать с WebDAV. В Far Manager'е, например, поддержка WebDAV есть во встроенном плагине NetBox. Для доступа к Яндекс.Диск непосредственно из Far Manager достаточно создать новое WebDAV соединение:<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image13201.png" />картинка во вложении</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">Для написания скрипта автоматической загрузки файлов на Яндекс.Диск мы будем использовать консольный клиент с поддержкой WebDAV. В данном случае мой выбор пал на многофункциональный </span><a href="http://winscp.net/"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#727272;">WinSCP</span></a><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">. С документацией по написанию скриптов для WinSCP можно ознакомиться </span><a href="http://winscp.net/eng/docs/scripting"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#727272;">здесь</span></a><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">Тут все как раз очень просто. Создаем файл upload.txt со следующим содержанием:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">open https://имя_пользователя:пароль@webdav.yandex.ru<br />put test.txt /<br />exit<br /><br />Где имя_пользователя - ваш аккаунт на Яндекс.Диск, с собакой и всем остальным. Пароль - пароль от этого аккаунта. test.txt - это файл, который мы хотим загрузить. И запускаем скрипт - </span><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; font-weight:600; color:#000000;">WinSCP.com /script=upload.txt</span><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;">.<br /><br />В результате наш файл загружается на Яндекс.Диск в корневую папку:<br /><br />Connecting to host...<br />Authenticating...<br />Authenticated.<br />Starting the session...<br />Session started.<br />Active session: [1] decker@yandex.ru@webdav.yandex.ru<br />test.txt                  |            6 B |    0,0 KB/s | binary | 100%<br /><br />Вот вообщем-то и всё. Если вы опасаетесь за безопасность персональных данных при хранении их в облаке - перед загрузкой backup'ов в облако их можно упаковывать в архив Rar с криптостойким паролем, либо применять другие способы шифрования загружаемых в облако файлов.<br /><br /></span><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; font-weight:600; color:#000000;">Полезные ссылки по теме:</span><span style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;"><br /><br /></span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;" style=" margin-top:7px; margin-bottom:3px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://xakep.ru/2014/09/09/webdav/"><span style=" text-decoration: underline; color:#727272;">Изучаем WebDAV</span></a></li>
<li style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:3px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://yandex.ru/support/disk/webdav.xml"><span style=" text-decoration: underline; color:#727272;">Доступ к Диску через WebDAV</span></a></li>
<li style=" font-family:'Verdana,Geneva,sans-serif'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:7px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.itshop.ru/Synapse-rabota-s-WebDAV-na-primere-YandeksDiska/l9i29182"><span style=" text-decoration: underline; color:#727272;">Synapse: работа с WebDAV на примере Яндекс.Диска.</span></a> - статья для тех, кто хочет написать собственное приложение с использованием возможностей WebDAV.</li></ul></body></html>