<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-style:italic; color:#808080;"># Chapter 5: Data Displays and Grids<br /># Recipe 1: Displaying lists of data<br />#<br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">import </span><span style=" font-family:'Courier New'; color:#000000;">wx<br /><br /><br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">class </span><span style=" font-family:'Courier New'; color:#000000;">BaseList(wx.ListCtrl):<br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#b200b2;">__init__</span><span style=" font-family:'Courier New'; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, parent):<br />        </span><span style=" font-family:'Courier New'; color:#000080;">super</span><span style=" font-family:'Courier New'; color:#000000;">(BaseList, </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#b200b2;">__init__</span><span style=" font-family:'Courier New'; color:#000000;">(parent, </span><span style=" font-family:'Courier New'; color:#660099;">style</span><span style=" font-family:'Courier New'; color:#000000;">=wx.LC_REPORT)<br /><br />        </span><span style=" font-family:'Courier New'; font-style:italic; color:#808080;"># контекстное меню<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.Bind(wx.EVT_LIST_ITEM_RIGHT_CLICK, </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.OnRClick)<br />        </span><span style=" font-family:'Courier New'; font-style:italic; color:#808080;"># добавление элементов меню забинденного в контекстное меню<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.Bind(wx.EVT_MENU, </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.OnMenu, </span><span style=" font-family:'Courier New'; color:#660099;">id</span><span style=" font-family:'Courier New'; color:#000000;">=wx.ID_COPY)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.Bind(wx.EVT_MENU, </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.OnMenu, </span><span style=" font-family:'Courier New'; color:#660099;">id</span><span style=" font-family:'Courier New'; color:#000000;">=wx.ID_SELECTALL)<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">OnRClick(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; color:#808080;">event</span><span style=" font-family:'Courier New'; color:#000000;">):<br />        menu = wx.Menu()<br />        menu.Append(wx.ID_COPY)<br />        menu.Append(wx.ID_SELECTALL)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.PopupMenu(menu)<br />        menu.Destroy()<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">OnMenu(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, event):<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">if </span><span style=" font-family:'Courier New'; color:#000000;">event.Id == wx.ID_COPY:<br />            </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.Copy()<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">elif </span><span style=" font-family:'Courier New'; color:#000000;">event.Id == wx.ID_SELECTALL:<br />            </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.SelectAll()<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">else</span><span style=" font-family:'Courier New'; color:#000000;">:<br />            event.Skip()<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">Copy(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">):<br />        </span><span style=" font-family:'Courier New'; font-style:italic; color:#808080;">&quot;&quot;&quot;Copy selected data to clipboard&quot;&quot;&quot;<br />        </span><span style=" font-family:'Courier New'; color:#000000;">text = </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.GetSelectedText()<br />        data_o = wx.TextDataObject()<br />        data_o.SetText(text)<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">if </span><span style=" font-family:'Courier New'; color:#000000;">wx.TheClipboard.IsOpened() </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">or </span><span style=" font-family:'Courier New'; color:#000000;">wx.TheClipboard.Open():<br />            wx.TheClipboard.SetData(data_o)<br />            wx.TheClipboard.Flush()<br />            wx.TheClipboard.Close()<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">GetSelectedText(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">):<br />        items = </span><span style=" font-family:'Courier New'; color:#000080;">list</span><span style=" font-family:'Courier New'; color:#000000;">()<br />        </span><span style=" font-family:'Courier New'; color:#808080;">nColumns </span><span style=" font-family:'Courier New'; color:#000000;">= </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.ColumnCount<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">for </span><span style=" font-family:'Courier New'; color:#000000;">item </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">in </span><span style=" font-family:'Courier New'; color:#000080;">range</span><span style=" font-family:'Courier New'; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.ItemCount):<br />            </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">if </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.IsSelected(item):<br />                items.append(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.GetRowText(item))<br />        text = </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">\n</span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;</span><span style=" font-family:'Courier New'; color:#000000;">.join(items)<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">return </span><span style=" font-family:'Courier New'; color:#000000;">text<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">GetRowText(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, idx):<br />        txt = </span><span style=" font-family:'Courier New'; color:#000080;">list</span><span style=" font-family:'Courier New'; color:#000000;">()<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">for </span><span style=" font-family:'Courier New'; color:#000000;">col </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">in </span><span style=" font-family:'Courier New'; color:#000080;">range</span><span style=" font-family:'Courier New'; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.ColumnCount):<br />            txt.append(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.GetItemText(idx, col))<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">return </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">\t</span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;</span><span style=" font-family:'Courier New'; color:#000000;">.join(txt)<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">SelectAll(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">):<br />        </span><span style=" font-family:'Courier New'; font-style:italic; color:#808080;">&quot;&quot;&quot;Select all items&quot;&quot;&quot;<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">for </span><span style=" font-family:'Courier New'; color:#000000;">item </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">in </span><span style=" font-family:'Courier New'; color:#000080;">range</span><span style=" font-family:'Courier New'; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.ItemCount):<br />            </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.Select(item, </span><span style=" font-family:'Courier New'; color:#0000ff;">1</span><span style=" font-family:'Courier New'; color:#000000;">)<br /><br /><br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">class </span><span style=" font-family:'Courier New'; color:#000000;">PersonnelList(BaseList):<br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#b200b2;">__init__</span><span style=" font-family:'Courier New'; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, parent):<br />        </span><span style=" font-family:'Courier New'; color:#000080;">super</span><span style=" font-family:'Courier New'; color:#000000;">(PersonnelList, </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#b200b2;">__init__</span><span style=" font-family:'Courier New'; color:#000000;">(parent)<br /><br />        </span><span style=" font-family:'Courier New'; font-style:italic; color:#808080;"># Add column headers<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.InsertColumn(</span><span style=" font-family:'Courier New'; color:#0000ff;">0</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;ID&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.InsertColumn(</span><span style=" font-family:'Courier New'; color:#0000ff;">1</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Name&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.InsertColumn(</span><span style=" font-family:'Courier New'; color:#0000ff;">2</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Email&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.InsertColumn(</span><span style=" font-family:'Courier New'; color:#0000ff;">3</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Phone#&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br /><br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">AddEmployee(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, id, name, email, phone):<br />        </span><span style=" font-family:'Courier New'; color:#808080;">item </span><span style=" font-family:'Courier New'; color:#000000;">= </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.Append((id, name, email, phone))<br /><br /><br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">class </span><span style=" font-family:'Courier New'; color:#000000;">MyFrame(wx.Frame):<br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#b200b2;">__init__</span><span style=" font-family:'Courier New'; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">, parent, title):<br />        </span><span style=" font-family:'Courier New'; color:#000080;">super</span><span style=" font-family:'Courier New'; color:#000000;">(MyFrame, </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#b200b2;">__init__</span><span style=" font-family:'Courier New'; color:#000000;">(parent, </span><span style=" font-family:'Courier New'; color:#660099;">title</span><span style=" font-family:'Courier New'; color:#000000;">=title)<br /><br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">._list = PersonnelList(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">)<br /><br />        </span><span style=" font-family:'Courier New'; font-style:italic; color:#808080;"># add some data<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">._list.AddEmployee(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;123&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Frank&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;f@email.com&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;555-1234&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">._list.AddEmployee(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;124&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Jane&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;j@email.com&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;555-1434&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">._list.AddEmployee(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;125&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Thor&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;t@email.com&quot;</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;555-1274&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br /><br /><br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">class </span><span style=" font-family:'Courier New'; color:#000000;">MyApp(wx.App):<br />    </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">def </span><span style=" font-family:'Courier New'; color:#000000;">OnInit(</span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">):<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.frame = MyFrame(</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">None</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; color:#660099;">title</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;Displaying lists of data&quot;</span><span style=" font-family:'Courier New'; color:#000000;">)<br />        </span><span style=" font-family:'Courier New'; color:#94558d;">self</span><span style=" font-family:'Courier New'; color:#000000;">.frame.Show();<br />        </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">return True<br /><br /><br />if </span><span style=" font-family:'Courier New'; color:#000000;">__name__ == </span><span style=" font-family:'Courier New'; font-weight:600; color:#008000;">&quot;__main__&quot;</span><span style=" font-family:'Courier New'; color:#000000;">:<br />    app = MyApp(</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">False</span><span style=" font-family:'Courier New'; color:#000000;">)<br />    app.MainLoop()<br /></span></pre></body></html>