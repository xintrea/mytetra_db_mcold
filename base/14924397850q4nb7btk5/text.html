<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отображает выборку в lookup-форме, возвращает результат в виде набора записей ILookupData, кот. Имеет следующие свойства и функции: LookupResult = lrOk или lrCancel. RecCount – количество записей, выбранных пользователем (если LookupResult= lrCancel, то 0) Data(AttrNo,RecNo : integer) – возвращает значение поля с номером AttrNo из выбранной записи с номером RecNo. Записи нумеруются от 1, поля от 0. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">function <span style=" font-weight:600;">DoLookup</span>(<br /><span style=" font-weight:600;">LookupControlClass</span>: <a href="bdn://Pascal/SimpleType/String"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">String</span></a>;<br /><span style=" font-weight:600;">EntityName</span>: <a href="bdn://Pascal/SimpleType/String"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">String</span></a>;<br /><span style=" font-weight:600;">LocateFieldNames</span>: <a href="bdn://Pascal/SimpleType/Array"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Array</span></a>;<br /><span style=" font-weight:600;">LocateFieldValues </span>: <a href="bdn://Pascal/SimpleType/Array"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Array</span></a>;<br /><span style=" font-weight:600;">ResultFieldNames </span>: <a href="bdn://Pascal/SimpleType/Array"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Array</span></a>;<br /><span style=" font-weight:600;">MultiSelect </span>: <a href="bdn://Pascal/SimpleType/Boolean"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Boolean</span></a><br />): <a href="bdn://Pascal/scriptclass/TbtkLookupData"><span style=" text-decoration: underline; color:#0000ff;">TbtkLookupData</span></a>;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Примеры</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример №1: <br /><span style=" font-style:italic;">R := DoLookup('TbtkLookupGridForm','maintree',['id'],[2629000],['id','sParentClass'],true);<br />if R.LookupResult=lrOk then </span><span style=" font-style:italic; color:#ff0000;">Message</span><span style=" font-style:italic;">+Dlg( VarToStr(R.Data(0,1))+'-&gt;'+R.Data(1,1), mtWarning, 'mbYes', 0 );</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример №2: <br />В данном примере рассматривается случай возврата значений из двух выборок. <br /><span style=" font-style:italic;">S := DoLookupEx('', 'SELRO_CNT_ContractChoose', <br />    ['SELRO_CNT_ContractChoose.id', 'SELROCL_CNT_ObligationChoose.id'], <br />    [GetVar('IDContract'), GetVar('IDObligation')], <br />    ['SELRO_CNT_ContractChoose.id', 'SELROCL_CNT_ObligationChoose.id'], false, <br />    ['Caption'], [GetFmtCaption('CONTRACTOBLFORCHOOSE', [GetVar('super$IDSettlerOut_HL'),GetVar('super$IDSettlerIn_HL')])]); <br />if s.LookupResult=lrOk then <br />begin <br />    ShowMessage(s.SelectData('SELRO_CNT_ContractChoose').RecCount); <br />    ShowMessage(s.SelectData('SELROCL_CNT_ObligationChoose').RecCount); <br />    setvar('IDContract', s.SelectData('SELRO_CNT_ContractChoose').Data[0,1]); <br />    setvar('IDObligation', s.SelectData('SELROCL_CNT_ObligationChoose').Data[0,1]); execsql('set'); <br />end; </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;"><br /></span>Для доступа вернувшимся значениям была использована структура: SelectData([имя выборки]).Data [AttrNo,RecNo] Её использование необходимо при явном указании имени поля ([имя выборки].[имя поля]), если поле указано неявно ([имя поля]), то вернувшиеся данные будут доступны непосредственно в свойстве “Data”, как это сделано в примере №1. </p></body></html>