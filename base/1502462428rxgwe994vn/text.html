<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:3px; margin-bottom:3px; margin-left:46px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:21.6px; background-color:#e3e8ed;"><span style=" font-family:'djv'; font-size:xx-large; color:#000000; background-color:#e3e8ed;">Шпаргалка по основным командам PostgreSQL</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px; line-height:24.5px; background-color:#ffffff;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Вся работа с PostgreSQL осуществляется под пользователем postgres.</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">$sudo su postgres</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Работать с PosgreSQL можно как в интерактивном режиме, так и из командной строки. Программа – psql.</span></p>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:19.2px;"><span style=" font-family:'djv'; font-size:x-large; color:#000000;">Основные команды PostgreSQL в интерактивном режиме:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:13px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\connect db_name – подключиться к базе с именем db_name</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\du – список пользователей</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\dp (или \z) – список таблиц, представлений, последовательностей, прав доступа к ним</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\di – индексы</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\ds – последовательности</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\dt – список таблиц</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\dt+ — список всех таблиц с описанием</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\dt *s* — список всех таблиц, содержащих s в имени</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\dv – представления</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\dS – системные таблицы</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\d+ – описание таблицы</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\o – пересылка результатов запроса в файл</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\l – список баз данных</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\i – читать входящие данные из файла</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\e – открывает текущее содержимое буфера запроса в редакторе (если иное не указано в окружении переменной EDITOR, то будет использоваться по умолчанию vi)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\d “table_name” – описание таблицы</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\i запуск команды из внешнего файла, например \i /my/directory/my.sql</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\pset – команда настройки параметров форматирования</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\echo – выводит сообщение</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\set – устанавливает значение переменной среды. Без параметров выводит список текущих переменных (\unset – удаляет).</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\? – справочник psql</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\help – справочник SQL</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:13px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">\q (или Ctrl+D) – выход с программы</span></li></ul>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:19.2px;"><span style=" font-family:'djv'; font-size:x-large; color:#000000;">Работа с PostgreSQL из командной строки:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:13px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-c (или –command) – запуск команды SQL без выхода в интерактивный режим</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-f file.sql — выполнение команд из файла file.sql</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-l (или –list) – выводит список доступных баз данных</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-U (или –username) – указываем имя пользователя (например postgres)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-W (или –password) – приглашение на ввод пароля</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-d dbname — подключение к БД dbname</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-h – имя хоста (сервера)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-s – пошаговый режим, то есть, нужно будет подтверждать все команды</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">–S – однострочный режим, то есть, переход на новую строку будет выполнять запрос (избавляет от ; в конце конструкции SQL)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:13px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-V – версия PostgreSQL без входа в интерактивный режим</span></li></ul>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16.8px;"><span style=" font-family:'djv'; font-size:large; color:#000000;">Примеры:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">psql -U postgres -d dbname -c “CREATE TABLE my(some_id serial PRIMARY KEY, some_text text);” — выполнение команды в базе dbname.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">psql -d dbname -H -c «SELECT * FROM my» -o my.html — вывод результата запроса в html-файл.</span></p>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:19.2px;"><span style=" font-family:'djv'; font-size:x-large; color:#000000;">Утилиты (программы) PosgreSQL:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:13px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">createdb и dropdb – создание и удаление базы данных (соответственно)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">createuser и dropuser – создание и пользователя (соответственно)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">pg_ctl – программа предназначенная для решения общих задач управления (запуск, останов, настройка параметров и т.д.)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">postmaster – многопользовательский серверный модуль PostgreSQL (настройка уровней отладки, портов, каталогов данных)</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">initdb – создание новых кластеров PostgreSQL</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">initlocation – программа для создания каталогов для вторичного хранения баз данных</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">vacuumdb – физическое и аналитическое сопровождение БД</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">pg_dump – архивация и восстановление данных</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">pg_dumpall – резервное копирование всего кластера PostgreSQL</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:13px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">pg_restore – восстановление БД из архивов (.tar, .tar.gz)</span></li></ul>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16.8px;"><span style=" font-family:'djv'; font-size:large; color:#000000;">Примеры создания резервных копий:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Создание бекапа базы mydb, в сжатом виде</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_dump -h localhost -p 5440 -U someuser -F c -b -v -f mydb.backup mydb</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Создание бекапа базы mydb, в виде обычного текстового файла, включая команду для создания БД</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_dump -h localhost -p 5432 -U someuser -C -F p -b -v -f mydb.backup mydb</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Создание бекапа базы mydb, в сжатом виде, с таблицами которые содержат в имени payments</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_dump -h localhost -p 5432 -U someuser -F c -b -v -t *payments* -f payment_tables.backup mydb</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Дамп данных только одной, конкретной таблицы. Если нужно создать резервную копию нескольких таблиц, то имена этих таблиц перечисляются с помощью ключа -t для каждой таблицы.</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_dump -a -t table_name -f file_name database_name</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Создание резервной копии с сжатием в gz</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_dump -h localhost -O -F p -c -U postgres mydb | gzip -c &gt; mydb.gz</span></pre>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16.8px;"><span style=" font-family:'djv'; font-size:medium; color:#000000;">Список наиболее часто используемых опций:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:13px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-h host — хост, если не указан то используется localhost или значение из переменной окружения PGHOST.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-p port — порт, если не указан то используется 5432 или значение из переменной окружения PGPORT.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-u — пользователь, если не указан то используется текущий пользователь, также значение можно указать в переменной окружения PGUSER.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-a, —data-only — дамп только данных, по-умолчанию сохраняются данные и схема.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-b — включать в дамп большие объекты (blog’и).</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-s, —schema-only — дамп только схемы.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-C, —create — добавляет команду для создания БД.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-c — добавляет команды для удаления (drop) объектов (таблиц, видов и т.д.).</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-O — не добавлять команды для установки владельца объекта (таблиц, видов и т.д.).</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-F, —format {c|t|p} — выходной формат дампа, custom, tar, или plain text.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-t, —table=TABLE — указываем определенную таблицу для дампа.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:0px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-v, —verbose — вывод подробной информации.</span></li>
<li style=" font-family:'djv'; font-size:14px; color:#304050;" style=" margin-top:5px; margin-bottom:13px; margin-left:7px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><span style=" font-size:14px;">-D, —attribute-inserts — дамп используя команду INSERT с списком имен свойств.</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Бекап всех баз данных используя команду pg_dumpall.</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_dumpall &gt; all.sql</span></pre>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16.8px;"><span style=" font-family:'djv'; font-size:large; color:#000000;">Восстановление таблиц из резервных копий (бэкапов):</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">psql — восстановление бекапов, которые хранятся в обычном текстовом файле (plain text);<br />pg_restore — восстановление сжатых бекапов (tar);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Восстановление всего бекапа с игнорированием ошибок</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">psql -h localhost -U someuser -d dbname -f mydb.sql</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Восстановление всего бекапа с остановкой на первой ошибке</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">psql -h localhost -U someuser —set ON_ERROR_STOP=on -f mydb.sql</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Для восстановления из tar-арихива нам понадобиться сначала создать базу с помощью CREATE DATABASE mydb; (если при создании бекапа не была указана опция -C) и восстановить</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">pg_restore —dbname=mydb —jobs=4 —verbose mydb.backup</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:20px;"><span style=" font-family:'djv'; font-size:14px; color:#000000;">Восстановление резервной копии БД, сжатой gz</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">gunzip mydb.gz</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New,courier'; font-size:14px; color:#000000; background-color:#f5f5f5;">psql -U postgres -d mydb -f mydb</span></pre></body></html>