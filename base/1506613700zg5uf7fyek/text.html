<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">У замыканий есть два важных свойства.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">1. Замыкание может обращаться к переменным своей внешней функции даже после ее окончания выполнения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">На практике это означает что даже после того как выполнение внешней функции завершено, внутренняя все еще может быть вызвана и имеет доступ к переменным внешней функции.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Давайте рассмотрим пример:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">function</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">pirate</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">() {<br />    </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">var</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> pirateName = </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#2aa198; background-color:#fdf6e3;">&quot;noname&quot;</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">;<br />    </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">return</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> {<br />        getName: </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">function</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">() {<br />            </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">return</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> pirateName;<br />        },<br />        setName: </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">function</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">(newName) {<br />            pirateName = newName;<br />        }<br />    }<br />}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Roboto,sans-serif'; font-size:16px; color:#000000;"><br />Мы описали функцию с двумя замыканиями: одно возвращает значение переменной из вызывающей функции, второе - изменяет его. Посмотрим, что получится при практическом использовании:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">var</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> newPirate = pirate();<br /></span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">console</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">.log(newPirate.getName());    </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">// Выводим текущее содержимое переменной - там изначальный &quot;noname&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">newPirate.setName(</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#2aa198; background-color:#fdf6e3;">&quot;Jack Sparrow&quot;</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">);   </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">//Изменяем значение переменной на &quot;Jack Sparrow&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">console</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">.log(newPirate.getName());    </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">//Выводим текущее содержимое переменной - получаем &quot;Jack Sparrow&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />В данном примере мы видим что замыкания получили доступ к переменной внешней функции после ее завершения.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Roboto,sans-serif'; font-size:16px; font-weight:696; color:#000000;">2. Замыкания хранят не содержимое переменных внешней функции, а ссылки на эти переменные.</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.6%; background-color:#ffffff;"><span style=" font-family:'Roboto,sans-serif'; font-size:16px; color:#000000; background-color:#ffffff;">Давайте в этом контексте рассмотрим классический пример замыкания, описываемый в большинстве источников - счетчик.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">function</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">makeCounter</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">(initialValue) { <br />  </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">var</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> currentState = initialValue;<br />  </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">return</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">function</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> () {<br />    currentState = currentState + </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#2aa198; background-color:#fdf6e3;">1</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">;<br />    </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">return</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> currentState;<br />  }<br />}</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.6%; background-color:#ffffff;"><span style=" font-family:'Roboto,sans-serif'; font-size:16px; color:#000000; background-color:#ffffff;">В данном случае мы описали функцию, внутри которой находится замыкание, увеличивающее каждый раз счетчик и возвращающее его.</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.6%; background-color:#ffffff;"><span style=" font-family:'Roboto,sans-serif'; font-size:16px; color:#000000; background-color:#ffffff;">Давайте посмотрим, что получится если вызывать ее много раз пордряд.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#859900; background-color:#fdf6e3;">var</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;"> myCounter = makeCounter(</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#2aa198; background-color:#fdf6e3;">5</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">);  </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">// Создаем экземпляр счетчика и устанавливаем его начальное значение = 5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">console</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">.log(myCounter());        </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">// В консоль будет выведено значение 6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">console</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">.log(myCounter());        </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">// В консоль будет выведено значение 7 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#268bd2; background-color:#fdf6e3;">console</span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#000000; background-color:#fdf6e3;">.log(myCounter());        </span><span style=" font-family:'Consolas,Liberation Mono,Courier,monospace'; font-size:16px; color:#93a1a1; background-color:#fdf6e3;">// В консоль будет выведено значение 8 </span><br /></p></body></html>