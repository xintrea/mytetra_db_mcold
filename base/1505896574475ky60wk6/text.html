<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Columns Columns define the fields that exists in our tables, and they provide the primary means by which we define other constraints through their keyword arguments. Dif‐ ferent types of columns have different primary arguments. For example, String type columns have length as their primary argument, while numbers with a fractional component will have precision and length. Most other types have no primary argu‐ ments. Sometimes you will see examples that just show String columns without a length, which is the primary argument. This behavior is not universally supported—for example, MySQL and several other database backends do not allow for it. Columns can also have some additional keyword arguments that help shape their behavior even further. We can mark columns as required and/or force them to be unique. We can also set default initial values and change values when the record is updated. A common use case for this is fields that indicate when a record was created or updated for logging or auditing purposes. Let’s take a look at these keyword argu‐ ments in action in Example 1-2</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">from </span><span style=" font-family:'Courier New'; color:#000000;">datetime </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">import </span><span style=" font-family:'Courier New'; color:#000000;">datetime<br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">from </span><span style=" font-family:'Courier New'; color:#000000;">sqlalchemy </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">import </span><span style=" font-family:'Courier New'; color:#000000;">Table, Column, Integer, Numeric, String, ForeignKey<br /></span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">from </span><span style=" font-family:'Courier New'; color:#000000;">sqlalchemy </span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">import </span><span style=" font-family:'Courier New'; color:#000000;">DateTime<br /><br />users = Table(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'users'</span><span style=" font-family:'Courier New'; color:#000000;">, metadata,<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'user_id'</span><span style=" font-family:'Courier New'; color:#000000;">, Integer(), </span><span style=" font-family:'Courier New'; color:#660099;">primary_key</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">True</span><span style=" font-family:'Courier New'; color:#000000;">),<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'username'</span><span style=" font-family:'Courier New'; color:#000000;">, String(</span><span style=" font-family:'Courier New'; color:#0000ff;">15</span><span style=" font-family:'Courier New'; color:#000000;">), </span><span style=" font-family:'Courier New'; color:#660099;">nullable</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">False</span><span style=" font-family:'Courier New'; color:#000000;">, </span><span style=" font-family:'Courier New'; color:#660099;">unique</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">True</span><span style=" font-family:'Courier New'; color:#000000;">),<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'email_address'</span><span style=" font-family:'Courier New'; color:#000000;">, String(</span><span style=" font-family:'Courier New'; color:#0000ff;">255</span><span style=" font-family:'Courier New'; color:#000000;">), </span><span style=" font-family:'Courier New'; color:#660099;">nullable</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">False</span><span style=" font-family:'Courier New'; color:#000000;">),<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'phone'</span><span style=" font-family:'Courier New'; color:#000000;">, String(</span><span style=" font-family:'Courier New'; color:#0000ff;">20</span><span style=" font-family:'Courier New'; color:#000000;">), </span><span style=" font-family:'Courier New'; color:#660099;">nullable</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">False</span><span style=" font-family:'Courier New'; color:#000000;">),<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'password'</span><span style=" font-family:'Courier New'; color:#000000;">, String(</span><span style=" font-family:'Courier New'; color:#0000ff;">25</span><span style=" font-family:'Courier New'; color:#000000;">), </span><span style=" font-family:'Courier New'; color:#660099;">nullable</span><span style=" font-family:'Courier New'; color:#000000;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#000080;">False</span><span style=" font-family:'Courier New'; color:#000000;">),<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'created_on'</span><span style=" font-family:'Courier New'; color:#000000;">, DateTime(), </span><span style=" font-family:'Courier New'; color:#660099;">default</span><span style=" font-family:'Courier New'; color:#000000;">=datetime.now),<br />     Column(</span><span style=" font-family:'Courier New'; font-weight:600; color:#008080;">'updated_on'</span><span style=" font-family:'Courier New'; color:#000000;">, DateTime(), </span><span style=" font-family:'Courier New'; color:#660099;">default</span><span style=" font-family:'Courier New'; color:#000000;">=datetime.now, </span><span style=" font-family:'Courier New'; color:#660099;">onupdate</span><span style=" font-family:'Courier New'; color:#000000;">=datetime.now)<br />)<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Here we are making this column required (nullable=False) and also requiring a unique value. The default sets this column to the current time if a date isn’t specified. Using onupdate here will reset this column to the current time every time any part of the record is updated.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">You’ll notice that we set default and onupdate to the callable date time.now instead of the function call itself, datetime.now()<span style=" font-family:'FreeMono'; font-weight:600; color:#6a1009;">. If we had used the function call itself, it would have set the default to the time when the table was first instantiated. By using the callable, we get the time that each individual record is instantiated and updated.</span></p></body></html>